\documentclass[10pt,a4paper,fleqn]{book}

\usepackage[usenames]{color} 
\usepackage{graphicx} 

\usepackage{subfigure}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{fancyhdr}

\usepackage{amsfonts,psfrag,layout,appendix}
\usepackage{natbib}
%\usepackage{chapterbib}


\definecolor{lightblue}{rgb}{0.0, 0.8,1.0} 
\definecolor{myOrange}{rgb}{1.0, 0.6,0.0} 
\definecolor{myGrey}{rgb}{0.1, 0.1,0.1} 
\definecolor{MyDarkGreen}{rgb}{0.13, 0.54,0.13} 
\newcommand{\todo}[1]{\textcolor{red}{\textbf{\newline TODO: }\it{#1} \newline}}
\newcommand{\inhoud}[1]{\textcolor{blue}{\textbf{\newline Summary: }\it{#1}}}
\newcommand{\revise}[1]{\textcolor{myOrange}{\textbf{\newline Revise: }\it{#1}}}
\newcommand{\old}[1]{\textcolor{myGrey}{\small{\textbf{\newline Old: }\it{#1}}}}
\newcommand{\desc}[1]{\textcolor{lightblue}{\textbf{\newline description: }\it{#1} \newline}}
\newcommand{\voegtoe}[1]{\textcolor{MyDarkGreen}{\textbf{-Insert: }\it{#1}}}


% Dutch style of paragraph formatting, i.e. no indents. 
\setlength{\parskip}{1.3ex plus 0.2ex minus 0.2ex}
\setlength{\parindent}{0pt}
% Set equal margins on book style
\setlength{\oddsidemargin}{53pt}
\setlength{\evensidemargin}{53pt}
\setlength{\marginparwidth}{57pt}
\setlength{\footskip}{30pt}


% Redefine plain page style
\fancypagestyle{plain}{
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\fancyfoot[LE,RO]{\thepage}
}

% Code for creating empty pages
% No headers on empty pages before new chapter
\makeatletter
\def\cleardoublepage{\clearpage\if@twoside \ifodd\c@page\else
    \hbox{}
    \thispagestyle{plain}
    \newpage
    \if@twocolumn\hbox{}\newpage\fi\fi\fi}
\makeatother \clearpage{\pagestyle{plain}\cleardoublepage}


\pagestyle{fancy}
\renewcommand{\chaptermark}[1]{\markboth{ \emph{#1}}{}}
\fancyhead[LO]{}
\fancyhead[RE]{\leftmark}
\fancyfoot[LE,RO]{\thepage}


\title{Planning Procedural Architecture in Tree-like Geometry}
\author{Ruud op den Kelder}

\begin{document}

\frontmatter

\include{titlepage}
\include{abstract}

\tableofcontents

\mainmatter
% Adjustments headers
\fancyhead[LO]{\leftmark}
\fancyhead[RE]{\emph{Chapter \thechapter}}

%chapter 1
\include{introduction}
%chapter 2
\include{state_of_the_art}
%chapter 3
\include{problem_statement}
%chapter 4 
\include{concept}
%chapter 5
\include{procedural_forest_generation}
%chapter 6
\include{architecture}
%chapter 7 (optional)
\include{interaction_tools} 
%chapter 8 Results 
\include{results}
%chapter 9 conclusion
\include{conclusion}


\appendix
\noappendicestocpagenum
\addappheadtotoc

% Adjustments headers
\pagestyle{fancy}
\fancyhead[LO]{\leftmark}
\fancyhead[RE]{\emph{Appendix \thechapter}}
\renewcommand{\headrulewidth}{0.5pt}

\chapter*{Appendix A: Implementation}
\label{sec:implementation}

%\chapter*{Appendix B: Application Class Structure}

\newpage 
\pagestyle{plain}
\addcontentsline{toc}{chapter}{Bibliography}
\bibliographystyle{abbrv}	% (uses file "plain.bst")
\bibliography{thesisrefs}	% expects file "myrefs.bib"

\end{document}

